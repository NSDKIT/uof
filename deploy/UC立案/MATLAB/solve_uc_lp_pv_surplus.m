fun = @(p)((a_k(1)/p(1)*p(1)+b_k(1)*p(1)+c_k(1)*p(1)^2)+(a_k(2)/p(2)*p(2)+b_k(2)*p(2)+c_k(2)*p(2)^2)+...
    (a_k(3)/p(3)*p(3)+b_k(3)*p(3)+c_k(3)*p(3)^2)+(a_k(4)/p(4)*p(4)+b_k(4)*p(4)+c_k(4)*p(4)^2)+...
    (a_k(5)/p(5)*p(5)+b_k(5)*p(5)+c_k(5)*p(5)^2)+(a_k(6)/p(6)*p(6)+b_k(6)*p(6)+c_k(6)*p(6)^2)+...
    (a_k(7)/p(7)*p(7)+b_k(7)*p(7)+c_k(7)*p(7)^2)+(a_k(8)/p(8)*p(8)+b_k(8)*p(8)+c_k(8)*p(8)^2)+...
    (a_k(9)/p(9)*p(9)+b_k(9)*p(9)+c_k(9)*p(9)^2)+(a_k(10)/p(10)*p(10)+b_k(10)*p(10)+c_k(10)*p(10)^2)+...
    (a_k(11)/p(11)*p(11)+b_k(11)*p(11)+c_k(11)*p(11)^2)+...
    -p(12)*8000*(1+0.5)); % PV抑制量=PV買取価格(1+α)×PV抑制量=8000(1+0.5)×p(12)
% PV買取価格8000円/MWh, かんたん固定価格プラン（https://www.rikuden.co.jp/koteikaitori/kaitorimenu.html）
x0=[x0,0];
Aeq=[Aeq,1];
lb=[lb;-inf];
ub=[ub;beq-lb_sum];